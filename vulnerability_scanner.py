import requests
from bs4 import BeautifulSoup

sql_payload = "' OR '1'='1"
xss_payload = "<script>alert('XSS')</script>"

def test_sql_injection(url):
    vulnerable = False
    try:
        r = requests.get(url + "?id=" + sql_payload)
        if "sql" in r.text.lower() or "error" in r.text.lower():
            print(" SQL Injection vulnerability found!")
            vulnerable = True
    except:
        print(" Error while testing SQLi.")
    return vulnerable

def test_xss(url):
    try:
        r = requests.get(url + "?q=" + xss_payload)
        if xss_payload in r.text:
            print(" XSS vulnerability found!")
            return True
    except:
        print(" Error while testing XSS.")
    return False

def scan_forms(url):
    try:
        r = requests.get(url)
        soup = BeautifulSoup(r.text, "html.parser")
        forms = soup.find_all("form")
        print(f" Found {len(forms)} form(s)")

        for form in forms:
            action = form.get("action")
            method = form.get("method", "get").lower()
            inputs = form.find_all("input")

            data = {}
            for i in inputs:
                name = i.get("name")
                if name:
                    data[name] = xss_payload  # Use XSS for testing

            target = url + action if action else url
            print(f" Testing form at: {target}")

            if method == "post":
                res = requests.post(target, data=data)
            else:
                res = requests.get(target, params=data)

            if xss_payload in res.text:
                print(" XSS vulnerability found in form!")
    except:
        print(" Error scanning forms.")

if __name__ == "__main__":
    target_url = input(" Enter the URL to scan: ").strip()

    print("\n Scanning for vulnerabilities...\n")

    if test_sql_injection(target_url):
        print(" SQL Injection test complete.")
    else:
        print("✔ No SQLi vulnerability detected.")

    if test_xss(target_url):
        print(" XSS test complete.")
    else:
        print("✔ No XSS vulnerability detected.")

    print("\n Scanning HTML forms...\n")
    scan_forms(target_url)